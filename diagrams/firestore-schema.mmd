flowchart TD

    subgraph F["folios/{folioId}"]
        F_id[folioId]
        F_bucket[bucket]
        F_prefix[folder_prefix]
        F_status[status]
        F_total[total_docs]
        F_proc[processed_docs]
        F_created[created_at]
        F_started[started_at]
        F_finished[finished_at]
        F_updated[last_update_at]
    end

    F --> D["folios/{folioId}/documentos/{docId}"]

    subgraph D["documentos/{docId}"]
        D_docId[docId]
        D_folio[folioId]
        D_fileId[fileId]
        D_gcs[gcsUri]
        D_gen[generation]
        D_status[status]
        D_type[doc_type]
        D_classConf[classifier_confidence]
        D_classVer[classifier_version]
        D_updated[updated_at]
        D_completed[completed_at]

        subgraph ERR["error? (si status=ERROR)"]
            E_type[error_type]
            E_msg[error_message]
        end
    end

    D --> E["folios/{folioId}/documentos/{docId}/extracciones/{extractionId}"]

    subgraph E["extracciones/{extractionId}"]
        E_id[extractionId]
        E_created[created_at]

        subgraph FIELDS["fields"]
            F_org[ORG_NAME]
            F_period[REPORTING_PERIOD]
            F_currency[CURRENCY]
            F_scale[UNITS_SCALE]
            F_title[STATEMENT_TITLE]

            subgraph LINES["line_items[]"]
                L_name[LINE_ITEM_NAME]
                L_value[LINE_ITEM_VALUE]
                L_year[COLUMN_YEAR]
                L_section[SECTION_HEADER]
                L_total[TOTAL_LABEL]
            end
        end

        subgraph META["metadata"]
            M_pages[page_count]
            M_procVer[processor_version]
            M_schema[extraction_schema_version]
        end
    end
